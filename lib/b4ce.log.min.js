(function(e,t){"use strict";"function"==typeof define&&define.amd?define(["underscore"],t):(e.B4ce||(e.B4ce={}),e.B4ce.Log||(e.B4ce.Log={}),e.B4ce.Log.Util=t(e._))})(this,function(e){"use strict";return{capitalize:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},createMethod:function(t,n){var i=t;return"common"===t?function(){var o=Array.prototype.slice.call(arguments,arguments);return i=e.isArray(o[0])||e.isNumber(o[0])?o.shift():[t],this.logMessage(i,n,o)}:function(){var e=Array.prototype.slice.call(arguments,arguments);return this.logMessage([i],n,e)}},extend:function(t,n){var i,o=this;i=t&&e.has(t,"constructor")?t.constructor:function(){return o.apply(this,arguments)},e.extend(i,o,n);var r=function(){this.constructor=i};return r.prototype=o.prototype,i.prototype=new r,t&&e.extend(i.prototype,t),i.__super__=o.prototype,i},sanitizeBrowser:function(){Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,i=function(){},o=function(){return n.apply(this instanceof i&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};return i.prototype=this.prototype,o.prototype=new i,o}),Array.prototype.forEach||(Array.prototype.forEach=function(e,t){var n,i;if(null===this)throw new TypeError("this is null or not defined");var o=Object(this),r=o.length>>>0;if("[object Function]"!=={}.toString.call(e))throw new TypeError(e+" is not a function");for(t&&(n=t),i=0;r>i;){var s;i in o&&(s=o[i],e.call(n,s,i,o)),i++}}),Function.prototype.bind&&Array.prototype.forEach&&"object"==typeof console&&"object"==typeof console.log&&["log","info","warn","error","assert","dir","clear","profile","profileEnd"].forEach(function(e){console[e]&&(console[e]=this.bind(console[e],console))},Function.prototype.call)}}}),function(e,t){"use strict";"function"==typeof define&&define.amd?define(["underscore","./b4ce.log.util"],t):(e.B4ce||(e.B4ce={}),e.B4ce.Log||(e.B4ce.Log={}),e.B4ce.Log.Channel=t(e._,e.B4ce.Log.Util))}(this,function(e,t){"use strict";var n=function(t){e.extend(this,t)};return n.extend=t.extend,e.extend(n.prototype,{filter:function(t,n){return this.level&&this.log.levels[n]<this.log.levels[this.level]?!1:!(this.categories&&!e.intersect(this.categories,t).length)},timestamp:function(){return(new Date).toISOString()},prefix:function(t,n,i){var o,r=[];return(o=this.timestamp(t,n,i))&&r.push(o),r.push(n.toUpperCase()),o=e.without(t,"common"),o.length&&r.push(" ["+o.join(",")+"]"),r.join(" ")+":"},format:function(e,t,n){return this.prefix(e,t,n)+" "+n.join(" ")},write:function(){throw"Channel.write has to be overriden by actual channel implementation!"}}),n}),function(e,t){"use strict";"function"==typeof define&&define.amd?define(["underscore","./b4ce.log.channel"],t):(e.B4ce||(e.B4ce={}),e.B4ce.Log||(e.B4ce.Log={}),e.B4ce.Log.Channel||(e.B4ce.Log.Channel={}),e.B4ce.Log.Channel.Alert=t(e._,e.B4ce.Log.Channel))}(this,function(e,t){"use strict";var n=t.extend({constructor:function(n){n=e.extend({level:"alert"},n),t.call(this,n)},filter:function(e,n,i){return void 0===window.alert?!1:t.prototype.filter.call(this,e,n,i)},timestamp:function(){return null},write:function(e,t,n){window.alert(this.format(e,t,n))}});return n}),function(e,t){"use strict";"function"==typeof define&&define.amd?define(["underscore","./b4ce.log.channel"],t):(e.B4ce||(e.B4ce={}),e.B4ce.Log||(e.B4ce.Log={}),e.B4ce.Log.Channel||(e.B4ce.Log.Channel={}),e.B4ce.Log.Channel.Console=t(e._,e.B4ce.Log.Channel))}(this,function(e,t){"use strict";var n=t.extend({filter:function(e,n,i){return"object"!=typeof console||"function"!=typeof console.log?!1:t.prototype.filter.call(this,e,n,i)},format:function(e,t,n){return[this.prefix(e,t,n)].concat(n)},write:function(e,t,n){var i,o=this.log.levels[t];return i=o>=this.log.levels.err?console.error:o>=this.log.levels.warning?console.warn:console.log,i.apply(console,this.format(e,t,n)),this}});return n}),function(e,t){"use strict";"function"==typeof define&&define.amd?define(["underscore","./b4ce.log.util","./b4ce.log.channel"],t):e.B4ce.Log=t(e._,e.B4ce.Log.Util,e.B4ce.Log.Channel)}(this,function(e,t,n){"use strict";t.sanitizeBrowser();var i=function(i){var o,r,s,c,l,a,h={};if(i=i?e.clone(i):{},this.levels={emerg:8,alert:7,crit:6,err:5,warning:4,notice:3,info:2,debug:1},this.defaultLevel=i.defaultLevel?this.sanitizeLevel(i.defaultLevel):"debug",this.categoryLevel={},this.categories={common:1},i.categories){r=1;for(o in i.categories)i.categories.hasOwnProperty(o)&&(this.categories[o]||(r=2*r,this.categories[o]=r),this.categoryLevel[o]=i.categories[o]?this.sanitizeLevel(i.categories[o]):void 0)}for(o in this.categories)this.categories.hasOwnProperty(o)&&(this.categoryLevel[o]||(this.categoryLevel[o]=this.defaultLevel));i.channels||(i.channels={},n.Console&&(i.channels.console=new n.Console({log:this})),n.Alert&&(i.channels.alert=new n.Alert({log:this})));for(o in i.channels)if(i.channels.hasOwnProperty(o))if(r=i.channels[o],r instanceof n)h[o]=r;else{if(!this.channels[o])throw"Tried to configure invalid default channel: "+o;if(r!==!1){if(a={log:this},e.isObject(r))r.level&&(a.level=this.sanitizeLevel(r.level)),r.categories&&(a.categories=this.sanitizeCategories(r.categories));else if(r!==!0)throw'Invalid config for channel "'+o+'": '+r;h[o]=new this.channels[o](a)}}this.channels=h;for(s in this.categories)if(this.categories.hasOwnProperty(s))for(c in this.levels)this.levels.hasOwnProperty(c)&&(l="common"===s?c:s+t.capitalize(c),void 0!==this[l]?this.logMessage(this.categories.common,this.levels.info,'Cannot create log method "'+l+'"'):this[l]=t.createMethod(s,c))};return e.extend(i,{Util:t,Channel:n}),e.extend(i.prototype,{channels:{},logMessage:function(e,t,n){var i,o,r,s,c,l,a=[];for(e=this.sanitizeCategories(e),t=this.sanitizeLevel(t),o=0,r=e.length;r>o;o+=1)i=e[o],this.levels[t]>=this.levels[this.categoryLevel[i]]&&a.push(i);if(!a.length)return this;for(i in this.channels)this.channels.hasOwnProperty(i)&&(s=this.channels[i],c=!0,l=a,s.filter(a,t,n)&&s.write(a,t,n));return this},setLevel:function(e,t){var n;if(e=e&&""!==e?this.sanitizeLevel(e):void 0,void 0===t){void 0===e?e=this.defaultLevel:this.defaultLevel=e;for(n in this.categoryLevel)this.categoryLevel.hasOwnProperty(n)&&(this.categoryLevel[n]=e)}else{if(!this.categoryLevel.hasOwnProperty(t))throw"Invalid category: "+t;this.categoryLevel[t]=e}return this},sanitizeCategories:function(t){var n,i,o,r=[];if(e.isArray(t)){for(i=0,o=t.length;o>i;i+=1)if(!this.categories.hasOwnProperty(t[i]))throw"Invalid category: "+t[i];r=t.slice()}else{if(!e.isNumber(t))throw"Invalid categories argument: "+t;for(n in this.categories)this.categories.hasOwnProperty(n)&&this.categories[n]&t&&(r.push(n),t-=this.categories[n]);if(t>0)throw"Invalid numeric category value: "+t}return r},sanitizeLevel:function(t){var n;if(e.isString(t)){if(!this.levels.hasOwnProperty(t))throw"Invalid level: "+t;return t}if(e.isNumber(t)){for(n in this.levels)if(this.levels.hasOwnProperty(n)&&t===this.levels[n])return n;throw"Invalid numeric level: "+t}throw"Invalid level: "+t}}),i});