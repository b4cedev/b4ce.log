(function(e,t){"use strict";"function"==typeof define&&define.amd?define(["underscore"],t):(e.B4ce||(e.B4ce={}),e.B4ce.Log||(e.B4ce.Log={}),e.B4ce.Log.Util=t(e._))})(this,function(e){"use strict";return{capitalize:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},createMethod:function(t,n){var i=t;return"common"===t?function(){var o=Array.prototype.slice.call(arguments,arguments);return i=e.isArray(o[0])||e.isNumber(o[0])?o.shift():[t],this.logMessage(i,n,o)}:function(){var e=Array.prototype.slice.call(arguments,arguments);return this.logMessage([i],n,e)}},extend:function(t,n){var i,o=this;i=t&&e.has(t,"constructor")?t.constructor:function(){return o.apply(this,arguments)},e.extend(i,o,n);var r=function(){this.constructor=i};return r.prototype=o.prototype,i.prototype=new r,t&&e.extend(i.prototype,t),i.__super__=o.prototype,i},sanitizeBrowser:function(){Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var t=Array.prototype.slice.call(arguments,1),n=this,i=function(){},o=function(){return n.apply(this instanceof i&&e?this:e,t.concat(Array.prototype.slice.call(arguments)))};return i.prototype=this.prototype,o.prototype=new i,o}),Array.prototype.forEach||(Array.prototype.forEach=function(e,t){var n,i;if(null===this)throw new TypeError("this is null or not defined");var o=Object(this),r=o.length>>>0;if("[object Function]"!=={}.toString.call(e))throw new TypeError(e+" is not a function");for(t&&(n=t),i=0;r>i;){var s;i in o&&(s=o[i],e.call(n,s,i,o)),i++}}),Function.prototype.bind&&Array.prototype.forEach&&"object"==typeof console&&"object"==typeof console.log&&["log","info","warn","error","assert","dir","clear","profile","profileEnd"].forEach(function(e){console[e]&&(console[e]=this.bind(console[e],console))},Function.prototype.call)}}}),function(e,t){"use strict";"function"==typeof define&&define.amd?define(["underscore","./b4ce.log.util"],t):(e.B4ce||(e.B4ce={}),e.B4ce.Log||(e.B4ce.Log={}),e.B4ce.Log.Channel=t(e._,e.B4ce.Log.Util))}(this,function(e,t){"use strict";var n=function(t){e.extend(this,t)};return n.extend=t.extend,e.extend(n.prototype,{filter:function(t,n){return this.level&&this.log.levels[n]<this.log.levels[this.level]?!1:!(this.categories&&!e.intersect(this.categories,t).length)},timestamp:function(){return(new Date).toISOString()},prefix:function(t,n,i){var o,r=[];return(o=this.timestamp(t,n,i))&&r.push(o),r.push(n.toUpperCase()),o=e.without(t,"common"),o.length&&r.push(" ["+o.join(",")+"]"),r.join(" ")+":"},format:function(e,t,n){return this.prefix(e,t,n)+" "+n.join(" ")},write:function(){throw"Channel.write has to be overriden by actual channel implementation!"}}),n}),function(e,t){"use strict";"function"==typeof define&&define.amd?define(["underscore","./b4ce.log.channel"],t):(e.B4ce||(e.B4ce={}),e.B4ce.Log||(e.B4ce.Log={}),e.B4ce.Log.Channel||(e.B4ce.Log.Channel={}),e.B4ce.Log.Channel.Alert=t(e._,e.B4ce.Log.Channel))}(this,function(e,t){"use strict";var n=t.extend({constructor:function(n){n=e.extend({level:"alert"},n),t.call(this,n)},filter:function(e,n,i){return void 0===window.alert?!1:t.prototype.filter.call(this,e,n,i)},timestamp:function(){return null},write:function(e,t,n){window.alert(this.format(e,t,n))}});return n}),function(e,t){"use strict";"function"==typeof define&&define.amd?define(["underscore","./b4ce.log.channel"],t):(e.B4ce||(e.B4ce={}),e.B4ce.Log||(e.B4ce.Log={}),e.B4ce.Log.Channel||(e.B4ce.Log.Channel={}),e.B4ce.Log.Channel.Console=t(e._,e.B4ce.Log.Channel))}(this,function(e,t){"use strict";var n=t.extend({filter:function(e,n,i){return"object"!=typeof console||"function"!=typeof console.log?!1:t.prototype.filter.call(this,e,n,i)},format:function(e,t,n){return[this.prefix(e,t,n)].concat(n)},write:function(e,t,n){var i,o=this.log.levels[t];return i=o>=this.log.levels.err?console.error:o>=this.log.levels.warning?console.warn:console.log,i.apply(console,this.format(e,t,n)),this}});return n}),function(e,t){"use strict";"function"==typeof define&&define.amd?define(["underscore","./b4ce.log.util","./b4ce.log.channel","./b4ce.log.channel.alert","./b4ce.log.channel.console"],t):e.B4ce.Log=t(e._,e.B4ce.Log.Util,e.B4ce.Log.Channel,e.B4ce.Log.AlertChannel,e.B4ce.Log.ConsoleChannel)}(this,function(e,t,n,i,o){"use strict";t.sanitizeBrowser();var r={emerg:8,alert:7,crit:6,err:5,warning:4,notice:3,info:2,debug:1},s={alert:i,console:o},c=function(t){if(e.isUndefined(t))t={};else if(!e.isObject(t))throw Error("invalid options: "+JSON.stringify(t));t.defaultLevel&&(this.defaultLevel=this.sanitizeLevel(t.defaultLevel)),this.categories={common:1},this.categoryValMax=1,this.categoryLevel={},t.categories&&this.addCategories(t.categories),this.channels={},e.isUndefined(t.channels)?this.addChannels(s):this.addChannels(t.channels),this.createCategoryMethods()};return e.extend(c,{Util:t,Channel:n}),e.extend(c.prototype,{levels:r,defaultLevel:"debug",addCategory:function(e,t){return this.categories[e]||(this.categoryValMax*=2,this.categories[e]=this.categoryValMax),this.categoryLevel[e]=this.sanitizeLevel(t),this},addCategories:function(t){var n=this;if(e.isObject(t))e.each(t,function(e,t){n.addCategory(t,e)});else{if(!e.isArray(t))throw Error("categories is neither object nor array!");e.each(t,function(e){n.addCategory(e)})}return this},addChannel:function(t,i){if(this.channels[t])throw Error("Channel name already registered: "+t);if(i instanceof n)this.channels[t]=i;else if(e.isFunction(i))this.channels[t]=new i({log:this});else if(e.isFunction(s[t])){if(i===!1)return this;var o={log:this};e.isObject(i)&&e.extend(o,i),this.channels[t]=new s[t](o)}return this},addChannels:function(t){var n=this;if(!e.isObject(t))throw Error("channels is neither object nor array!");return e.each(t,function(e,t){n.addChannel(t,e)}),this},setLevel:function(e,t){var n;if(e=e&&""!==e?this.sanitizeLevel(e):void 0,void 0===t){void 0===e?e=this.defaultLevel:this.defaultLevel=e;for(n in this.categoryLevel)this.categoryLevel.hasOwnProperty(n)&&(this.categoryLevel[n]=e)}else{if(!this.categoryLevel.hasOwnProperty(t))throw"Invalid category: "+t;this.categoryLevel[t]=e}return this},createCategoryMethods:function(n){var i;if(e.isUndefined(n))i=e.keys(this.categories);else{if(!this.categories[n])throw Error("invalid category: "+JSON.stringify(n));i=[n]}var o=this;return e.each(i,function(n){e.each(o.levels,function(e,i){var r;r="common"===n?i:n+t.capitalize(i),void 0!==o[r]?o.logMessage(o.categories.common,o.levels.info,'Cannot create log method "'+r+'"'):o[r]=t.createMethod(n,i)})}),this},sanitizeCategories:function(t){var n,i,o,r=[];if(e.isArray(t)){for(i=0,o=t.length;o>i;i+=1)if(!this.categories.hasOwnProperty(t[i]))throw"Invalid category: "+t[i];r=t.slice()}else{if(!e.isNumber(t))throw"Invalid categories argument: "+t;for(n in this.categories)this.categories.hasOwnProperty(n)&&this.categories[n]&t&&(r.push(n),t-=this.categories[n]);if(t>0)throw"Invalid numeric category value: "+t}return r},sanitizeLevel:function(t){if(e.isUndefined(t))return t;if(e.isString(t)){if(!this.levels.hasOwnProperty(t))throw"Invalid string level: "+t;return t}if(e.isNumber(t)){var n;for(n in this.levels)if(this.levels.hasOwnProperty(n)&&t===this.levels[n])return n;throw"Invalid numeric level: "+t}throw"Invalid level: "+t},logMessage:function(e,t,n){var i,o,r,s,c,a,l=[];for(e=this.sanitizeCategories(e),t=this.sanitizeLevel(t),o=0,r=e.length;r>o;o+=1)i=e[o],this.levels[t]>=this.levels[this.categoryLevel[i]]&&l.push(i);if(!l.length)return this;for(i in this.channels)this.channels.hasOwnProperty(i)&&(s=this.channels[i],c=!0,a=l,s.filter(l,t,n)&&s.write(l,t,n));return this}}),c});